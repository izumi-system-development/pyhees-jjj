# Documenting業務 仕様書

## 概要

ベースコード（src/pyhees）に対するカスタムロジックの変更点を可視化し、チーム内での理解を促進するためのドキュメンテーション業務。

## 背景

- **ベースモジュール**: `src/pyhees` (フォーク元のGitHubとリンク)
- **カスタムアプリケーション**: `src/jjjexperiment/main.py` を中心とした全体アプリケーション
- `src/jjjexperiment` には以下が含まれる：
  - アプリケーション全体のコード（入力から出力まで）
  - カスタマイズされたモジュール部分
  - 各種カスタムロジック（ac_min_volume_input, carryover_heat, underfloor_ac等）

## カスタマイズの種類

- **jjj_mod**: 直接改変（ラッピングデコレータ使用）
- **jjj_cloning**: カスタムファイルに複製して改変
- **jjj_cloned**: 複製された側のオリジンコード

## 目的

1. `main.py`から始まる全体のアプリケーションフローを可視化
2. その中でベースの`pyhees`モジュールがどこで使われているかを明示
3. どの部分がカスタムロジックで置き換えられているかを示す
4. 全体フローの中で、既存モジュールのままである部分とカスタムコードに代わっている部分を区別して表示

## 対象読者

- 仕様を提案したチームメンバー
- コードが読めないチームメンバー
- プロジェクトの新規参加者

## 実装方針

### ダイアグラム形式
- **C4ダイアグラム**をmarkdownで記述
- プログラムに詳しくない人でも理解しやすい表現を重視
- 工数に応じて詳細度を調整可能な柔軟な構成

### 表現レベル（必要に応じて選択）
- **高レベル**: アプリケーション全体とベースモジュールの関係
- **中レベル**: main.pyと各カスタムロジックモジュールの関係  
- **詳細レベル**: 個別モジュール内でのベース関数とカスタム関数の関係

### 可視化のポイント
- ベースコード（src/pyhees）とカスタムコード（src/jjjexperiment）の区別
- カスタマイズの種類（jjj_mod, jjj_cloning, jjj_cloned）の明示
- 処理フローにおける既存モジュール使用箇所とカスタム置換箇所の識別

## 成果物構成

### ファイル構成
- **機能別にファイル分割**: 各カスタムロジック（ac_min_volume_input, carryover_heat, underfloor_ac等）ごとに独立したmarkdownファイル
- **シンプルな表現**: ベースロジックに対して一つのカスタムをレイヤーしている図を基本とする
- **見やすさ重視**: 複雑さを避け、理解しやすい構成を最優先

### ダイアグラムの基本構成
- ベースロジックの処理フロー
- カスタムロジックによる置換・拡張箇所の明示
- 入力から出力までの全体的な流れの可視化

## 作業手順

### Phase 1: ベースロジック構造化
1. **ベースロジックの分析**: src/pyheesの必要充分な範囲での構造把握
2. **処理フローの整理**: main.pyから始まる全体的な処理の流れを構造化
3. **基準ダイアグラムの作成**: ベースロジックのみの状態でのC4ダイアグラム作成

### Phase 2: カスタムロジック分析
1. **変更箇所の特定**: 各機能（ac_min_volume_input, carryover_heat等）ごとの変更点を特定
2. **カスタマイズ種別の分類**: jjj_mod, jjj_cloning, jjj_clonedの分類
3. **影響範囲の把握**: 各カスタムロジックがベースロジックに与える影響の範囲を特定

### Phase 3: 可視化・文書化
1. **機能別ダイアグラム作成**: 各カスタムロジックについて個別のmarkdownファイル作成
2. **視覚的差別化**: スタイル変更（色分け、線種変更等）でベースとカスタムを区別
3. **変更箇所の強調**: 置換・拡張された部分を視覚的に明示

### 視覚表現の工夫
- **色分け**: ベースロジック（青系）、カスタムロジック（赤系）等
- **線種変更**: 実線（既存）、破線（変更）、太線（新規追加）等
- **アイコン・記号**: 変更種別を示すマーカーの活用

## 重要な技術的背景

### プロジェクト構造の理解
- `src/pyhees`: フォーク元のベースモジュール（一部直接編集もあり）
- `src/jjjexperiment/main.py`: カスタムアプリケーションのエントリーポイント
- カスタムロジックフォルダ例: `ac_min_volume_input`, `carryover_heat`, `underfloor_ac`

### カスタマイズパターンの識別方法
- **jjj_mod**: デコレータによるラッピング → 元関数の動作を保持しつつ拡張
- **jjj_cloning**: ファイル複製による改変 → 独立したカスタム実装
- **jjj_cloned**: 複製元のオリジナル → 変更前の状態を保持

### 分析時の注意点
- ベースコード（src/pyhees）内にも直接編集箇所が存在する可能性
- main.pyを起点とした処理フロー全体を把握することが重要
- 各カスタムロジックは独立性を保ちつつ、全体のアプリケーションフローに統合されている

## 成功基準
- チーム内の非技術者でもカスタマイズ箇所が理解できる
- 仕様提案者が変更内容を思い出せる
- 新規参加者がプロジェクト構造を迅速に把握できる
- 各機能のベースロジックからの差分が明確に可視化されている